<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SCD Roots Portal</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    overflow: hidden;
  }
  #map {
    position: absolute;
    top: 50px;
    bottom: 50px;
    left: 50px;
    right: 50px;
    z-index: 1;
    border-radius: 12px;
    overflow: hidden;
  }
  /* Portal borders */
  .border {
    position: absolute;
    z-index: 2;
    background-size: cover;
    background-position: center;
    animation: glow 3s infinite alternate;
  }
  @keyframes glow {
    0% { box-shadow: 0 0 5px #ffd27f; }
    100% { box-shadow: 0 0 20px #ffcc66; }
  }
  .border.top {
    top: 0; left: 50px; right: 50px; height: 50px;
    background-image: url('images/border_top.jpg');
  }
  .border.bottom {
    bottom: 0; left: 50px; right: 50px; height: 50px;
    background-image: url('images/border_bottom.jpg');
  }
  .border.left {
    top: 0; bottom: 0; left: 0; width: 50px;
    background-image: url('images/border_left.jpg');
  }
  .border.right {
    top: 0; bottom: 0; right: 0; width: 50px;
    background-image: url('images/border_right.jpg');
  }
  /* Category icons */
  .category-icon {
    position: absolute;
    width: 40px; height: 40px;
    cursor: pointer;
    z-index: 3;
    transition: transform 0.2s ease;
  }
  .category-icon:hover {
    transform: scale(1.1);
  }
  .icon-soil { bottom: 5px; left: calc(50% - 20px); }
  .icon-fossil { top: calc(50% - 20px); left: 5px; }
  .icon-agriculture { top: 5px; left: calc(50% - 20px); }
  .icon-geology { top: calc(50% - 20px); right: 5px; }
  /* Popup styling */
  .popup-img {
    width: 100%;
    height: auto;
    margin-bottom: 0.5rem;
    border-radius: 4px;
  }
</style>
</head>
<body>

<div id="map"></div>

<!-- Portal borders -->
<div class="border top"></div>
<div class="border bottom"></div>
<div class="border left"></div>
<div class="border right"></div>

<!-- Category filter icons -->
<img src="images/icon_soil.png" class="category-icon icon-soil" onclick="filterMarkers('Soil')" title="Soil Sites">
<img src="images/icon_fossil.png" class="category-icon icon-fossil" onclick="filterMarkers('Fossil')" title="Fossil Sites">
<img src="images/icon_agriculture.png" class="category-icon icon-agriculture" onclick="filterMarkers('Agriculture')" title="Agriculture Sites">
<img src="images/icon_geology.png" class="category-icon icon-geology" onclick="filterMarkers('Geology')" title="Geology Sites">

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// Initialize map
const map = L.map('map').setView([40.1, -74.7], 7);

L.tileLayer('https://cartodb-basemaps-a.global.ssl.fastly.net/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
  attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/">CARTO</a>',
  subdomains: 'abcd',
  maxZoom: 19
}).addTo(map);

// Custom marker icons by category
const icons = {
  Soil: L.icon({ iconUrl: 'images/icon_soil.png', iconSize: [35, 35] }),
  Fossil: L.icon({ iconUrl: 'images/icon_fossil.png', iconSize: [35, 35] }),
  Agriculture: L.icon({ iconUrl: 'images/icon_agriculture.png', iconSize: [35, 35] }),
  Geology: L.icon({ iconUrl: 'images/icon_geology.png', iconSize: [35, 35] })
};

// Locations
const locations = [
  {
    name: "Hadrosaurus foulkii Discovery",
    coords: [39.910196, -75.02857],
    doc: "2025_001",
    title: "Hadrosaurus foulkii Discovery",
    category: "Fossil",
    image: "images/hadrosaurus.jpg"
  },
  {
    name: "Atlantochelys mortoni Discovery",
    coords: [40.3232, -74.2416],
    doc: "2025_002",
    title: "Atlantochelys mortoni Discovery",
    category: "Fossil",
    image: "images/atlantochelys.jpg"
  },
  {
    name: "Ohberg Mastodon Discovery",
    coords: [41.1923, -74.4715],
    doc: "2025_003",
    title: "Ohberg Mastodon Discovery",
    category: "Fossil",
    image: "images/mastodon.jpg"
  }
];

// Create markers
let markers = [];
locations.forEach(site => {
  let marker = L.marker(site.coords, { icon: icons[site.category] || icons.Soil })
    .bindPopup(`
      <img src="${site.image}" alt="${site.title}" class="popup-img" />
      <b>${site.name}</b><br>
      <a href="article.html?doc=${site.doc}&title=${encodeURIComponent(site.title)}">Read all about it!</a>
    `);
  marker.category = site.category;
  marker.addTo(map);
  markers.push(marker);
});

// Filtering function
function filterMarkers(category) {
  markers.forEach(marker => {
    if (category === 'all' || marker.category === category) {
      map.addLayer(marker);
    } else {
      map.removeLayer(marker);
    }
  });
}
</script>

</body>
</html>
